# QBE Start
data $fmt_d = { b "%d\n", b 0 }
data $fmt_ll = { b "%lld\n", b 0 }
data $fmt_bool = { b "bool: %d\n", b 0 }
data $fmt_ptr = { b "%p\n", b 0 }
data $fmt_arr_start = { b "{\n", b 0 }
data $fmt_arr_end = { b "}\n", b 0 }
type :slice = { l, l }
export function w $main() {
@start
%.s0 =l alloc4 12
%.s1 =w copy 1
%.s2 =w copy 2
%.s3 =w copy 3
%.s4 =l copy 0
%.s5 =l add %.s0, %.s4
storew %.s1, %.s5
%.s6 =l copy 4
%.s7 =l add %.s0, %.s6
storew %.s2, %.s7
%.s8 =l copy 8
%.s9 =l add %.s0, %.s8
storew %.s3, %.s9
%.s10 =l alloc8 16
%.s11 =l copy 8
%.s12 =l add %.s10, %.s11
storel %.s0, %.s10
%.s13 =l copy 3
storel %.s13, %.s12
%.s14 =w copy 0
%.s15 =l loadl %.s10
%.s16 =l extsw %.s14
%.s17 =l mul %.s16, 4
%.s18 =l add %.s15, %.s17
%.s19 =w loaduw %.s18
%.void =w call $printf(l $fmt_d, ..., w %.s19)
%.s20 =w copy 1
%.s21 =l loadl %.s10
%.s22 =l extsw %.s20
%.s23 =l mul %.s22, 4
%.s24 =l add %.s21, %.s23
%.s25 =w loaduw %.s24
%.void =w call $printf(l $fmt_d, ..., w %.s25)
%.s26 =w copy 2
%.s27 =l loadl %.s10
%.s28 =l extsw %.s26
%.s29 =l mul %.s28, 4
%.s30 =l add %.s27, %.s29
%.s31 =w loaduw %.s30
%.void =w call $printf(l $fmt_d, ..., w %.s31)
%.s32 =w call $hello.bar(l %.s10)
ret 0
}
export function  $hello.bar(l %.s0) {
@start
%.s1 =w copy 0
%.s2 =l loadl %.s0
%.s3 =l extsw %.s1
%.s4 =l mul %.s3, 4
%.s5 =l add %.s2, %.s4
%.s6 =w loaduw %.s5
%.void =w call $printf(l $fmt_d, ..., w %.s6)
%.s7 =w copy 1
%.s8 =l loadl %.s0
%.s9 =l extsw %.s7
%.s10 =l mul %.s9, 4
%.s11 =l add %.s8, %.s10
%.s12 =w loaduw %.s11
%.void =w call $printf(l $fmt_d, ..., w %.s12)
%.s13 =w copy 2
%.s14 =l loadl %.s0
%.s15 =l extsw %.s13
%.s16 =l mul %.s15, 4
%.s17 =l add %.s14, %.s16
%.s18 =w loaduw %.s17
%.void =w call $printf(l $fmt_d, ..., w %.s18)
ret
}
